<table id="allshop"></table>
<!-- hy -->
<script>
	
	$(function(){
		var datagrid;
		var editRow=undefined;
		var op;
		var flag;  
		datagrid=$('#allshop').datagrid({   
		    url:'../manager.do', 
		    queryParams:{op:"getShopInfo"},
		    fitColumns:true,
		    striped:true,
		    loadMsg:"数据加载中...",
		    pagination:true,
		    rownumbers:true,
		    sortName:'sids',
		    sortOrder:'asc',
		    remoteSort:false,
		     columns:[[ 
		       {field:'sids',title:'商家编号',width:20,align:'center',checkbox:true},   
		        {field:'sid',title:'商家编号',width:20,align:'center',sortable:true},   
		        {field:'saccounts',title:'商家号',width:20,align:'center'},  
		      	{field:'saddress',title:'地址',width:20,align:'center'},
		        {field:'sshopname',title:'商家名',width:20,align:'center'},
		        {field:'stype',title:'营销类型',width:20,align:'center'},
		        {field:'sname',title:'姓名',width:20,align:'center'},
		        {field:'semail',title:'邮箱',width:20,align:'center'},
		        {field:'slicense',title:'营业执照',width:20,align:'center',formatter:function(value,row,index){
					if(value=="yes"){
						return "有营业执照";
					}else if(value=="no"){
						return "没有营业执照";
					}else{
						return value;
					}
				}},
		        {field:'sphone',title:'手机',width:20,align:'center'},
		      	{field:'status',title:'是否激活，1(已激活)，0(未激活)',width:25,align:'center',editor:{type:"text",options:{required:true}},formatter:function(value,row,index){
					if(value==1){
						return "已激活";
					}else if(value==0){
						return "未激活";
					}else{
						return value;
					}
				}},
				/* {field:'_operate',title:'详情',width:20,align:'center',
	        	formatter: function(value,rowData,index){
					return '<a class="icon-search1 icon-padding" href="javascript:showShopSales(\''+rowData.sid+'\')">查看销量</a>';
				}*/
			
		    ]],
		    toolbar:[{
	    	text:"查看销量",
			iconCls:'icon-edit',
				handler:function(){
					//var df=$('#allshop').datagrid("getChecked");
					///alert(df);
					//var rows=datagrid.datagrid("getChecked")[0];
					$.post("../manager.do?op=findxiaoliang",{op:"findxiaoliang"},function(data){
					var arr1=new Array(data.obj.length);//用来存放sid
					var arr2=new Array(data.obj.length);//用来存放销售数量
					for(var i=0;i<data.obj.length;i++){
						arr1[i]=data.obj[i].SID +"-"+ data.obj[i].SSHOPNAME;
						arr2[i]=data.obj[i].SUM;
					}
						
					//基于准备好的DOM，初始化echcarts实例
			    	var myChart=echarts.init(document.getElementById('main'));
			    	
			    	//1.echarts:指定图表的配置项和数据
			    	var option={
			    		title:{
			    			text:'商家销量统计'
			    		},
			    		tooltip:{},
			    		legend:{
			    			data:['销量']
			    		},
			    		xAxis:{
			    			data:arr1
			    		},
			    		yAxis:{},
			    		series:[{
			    			name:'销量',
			    			type:'bar',
			    			data:arr2
			    		}]
			    	};
			    	//使用刚指定的配置项和数据显示图表。
			    	myChart.setOption(option);
			    	a
			    	
					},"json"); 
					//alert(rows[0]);
					$("#showShopSales").dialog("open");
					var sid=$("#sid").val();
					//alert("aa");
					console.info("查看销量");
				}
			}]
		});  
	});
	
</script>
<!--引入Echarts文件-->
<script type="text/javascript" src="../js/echarts-all.js"></script>
<div id="showShopSales" class="easyui-dialog" title="商家销售量" data-options="fit:true,iconCls:'icon-add',resizable:true,modal:true,closed:true">
	<!-- 为ECharts准备一个具备大小（宽高）的Dom -->  
   <div id="main" style="width:600px;height:400px;"></div>
    <script type="text/javascript">
    	
    	
    	//map：   JavaScript引入示例
    	/*myChart.setOption({
    		series:[{
    			type:'map',
    			map:'china'
    		}]
    	});*/
    	
    	
    </script>
</div>

